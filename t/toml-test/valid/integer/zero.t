# File automatically generated from BurntSushi/toml-test
use utf8;
use Test2::V0;
use Data::Dumper;
use Math::BigInt;
use Math::BigFloat;
use TOML::Tiny;

binmode STDIN,  ':encoding(UTF-8)';
binmode STDOUT, ':encoding(UTF-8)';

my $expected1 = {
               'a2' => bless( {
                                '_file' => '(eval 478)',
                                '_lines' => [
                                              7
                                            ],
                                'code' => sub {
                                              BEGIN {${^WARNING_BITS} = "\x55\x55\x55\x55\x55\x55\x55\x55\x55\x55\x55\x55\x15\x00\x04\x40\x05\x04\x50"}
                                              use strict;
                                              no feature ':all';
                                              use feature ':5.16';
                                              require Math::BigInt;
                                              my $got = 'Math::BigInt'->new($_);
                                              'Math::BigInt'->new('0')->beq($got);
                                          },
                                'name' => 'Math::BigInt->new("0")->beq($_)',
                                'operator' => 'CODE(...)'
                              }, 'Test2::Compare::Custom' ),
               'a3' => bless( {
                                '_file' => '(eval 481)',
                                '_lines' => [
                                              7
                                            ],
                                'code' => sub {
                                              BEGIN {${^WARNING_BITS} = "\x55\x55\x55\x55\x55\x55\x55\x55\x55\x55\x55\x55\x15\x00\x04\x40\x05\x04\x50"}
                                              use strict;
                                              no feature ':all';
                                              use feature ':5.16';
                                              require Math::BigInt;
                                              my $got = 'Math::BigInt'->new($_);
                                              'Math::BigInt'->new('0')->beq($got);
                                          },
                                'name' => 'Math::BigInt->new("0")->beq($_)',
                                'operator' => 'CODE(...)'
                              }, 'Test2::Compare::Custom' ),
               'b1' => bless( {
                                '_file' => '(eval 473)',
                                '_lines' => [
                                              7
                                            ],
                                'code' => sub {
                                              BEGIN {${^WARNING_BITS} = "\x55\x55\x55\x55\x55\x55\x55\x55\x55\x55\x55\x55\x15\x00\x04\x40\x05\x04\x50"}
                                              use strict;
                                              no feature ':all';
                                              use feature ':5.16';
                                              require Math::BigInt;
                                              my $got = 'Math::BigInt'->new($_);
                                              'Math::BigInt'->new('0')->beq($got);
                                          },
                                'name' => 'Math::BigInt->new("0")->beq($_)',
                                'operator' => 'CODE(...)'
                              }, 'Test2::Compare::Custom' ),
               'b2' => bless( {
                                '_file' => '(eval 480)',
                                '_lines' => [
                                              7
                                            ],
                                'code' => sub {
                                              BEGIN {${^WARNING_BITS} = "\x55\x55\x55\x55\x55\x55\x55\x55\x55\x55\x55\x55\x15\x00\x04\x40\x05\x04\x50"}
                                              use strict;
                                              no feature ':all';
                                              use feature ':5.16';
                                              require Math::BigInt;
                                              my $got = 'Math::BigInt'->new($_);
                                              'Math::BigInt'->new('0')->beq($got);
                                          },
                                'name' => 'Math::BigInt->new("0")->beq($_)',
                                'operator' => 'CODE(...)'
                              }, 'Test2::Compare::Custom' ),
               'b3' => bless( {
                                '_file' => '(eval 479)',
                                '_lines' => [
                                              7
                                            ],
                                'code' => sub {
                                              BEGIN {${^WARNING_BITS} = "\x55\x55\x55\x55\x55\x55\x55\x55\x55\x55\x55\x55\x15\x00\x04\x40\x05\x04\x50"}
                                              use strict;
                                              no feature ':all';
                                              use feature ':5.16';
                                              require Math::BigInt;
                                              my $got = 'Math::BigInt'->new($_);
                                              'Math::BigInt'->new('0')->beq($got);
                                          },
                                'name' => 'Math::BigInt->new("0")->beq($_)',
                                'operator' => 'CODE(...)'
                              }, 'Test2::Compare::Custom' ),
               'd1' => bless( {
                                '_file' => '(eval 482)',
                                '_lines' => [
                                              7
                                            ],
                                'code' => sub {
                                              BEGIN {${^WARNING_BITS} = "\x55\x55\x55\x55\x55\x55\x55\x55\x55\x55\x55\x55\x15\x00\x04\x40\x05\x04\x50"}
                                              use strict;
                                              no feature ':all';
                                              use feature ':5.16';
                                              require Math::BigInt;
                                              my $got = 'Math::BigInt'->new($_);
                                              'Math::BigInt'->new('0')->beq($got);
                                          },
                                'name' => 'Math::BigInt->new("0")->beq($_)',
                                'operator' => 'CODE(...)'
                              }, 'Test2::Compare::Custom' ),
               'd2' => bless( {
                                '_file' => '(eval 475)',
                                '_lines' => [
                                              7
                                            ],
                                'code' => sub {
                                              BEGIN {${^WARNING_BITS} = "\x55\x55\x55\x55\x55\x55\x55\x55\x55\x55\x55\x55\x15\x00\x04\x40\x05\x04\x50"}
                                              use strict;
                                              no feature ':all';
                                              use feature ':5.16';
                                              require Math::BigInt;
                                              my $got = 'Math::BigInt'->new($_);
                                              'Math::BigInt'->new('0')->beq($got);
                                          },
                                'name' => 'Math::BigInt->new("0")->beq($_)',
                                'operator' => 'CODE(...)'
                              }, 'Test2::Compare::Custom' ),
               'd3' => bless( {
                                '_file' => '(eval 472)',
                                '_lines' => [
                                              7
                                            ],
                                'code' => sub {
                                              BEGIN {${^WARNING_BITS} = "\x55\x55\x55\x55\x55\x55\x55\x55\x55\x55\x55\x55\x15\x00\x04\x40\x05\x04\x50"}
                                              use strict;
                                              no feature ':all';
                                              use feature ':5.16';
                                              require Math::BigInt;
                                              my $got = 'Math::BigInt'->new($_);
                                              'Math::BigInt'->new('0')->beq($got);
                                          },
                                'name' => 'Math::BigInt->new("0")->beq($_)',
                                'operator' => 'CODE(...)'
                              }, 'Test2::Compare::Custom' ),
               'h1' => bless( {
                                '_file' => '(eval 474)',
                                '_lines' => [
                                              7
                                            ],
                                'code' => sub {
                                              BEGIN {${^WARNING_BITS} = "\x55\x55\x55\x55\x55\x55\x55\x55\x55\x55\x55\x55\x15\x00\x04\x40\x05\x04\x50"}
                                              use strict;
                                              no feature ':all';
                                              use feature ':5.16';
                                              require Math::BigInt;
                                              my $got = 'Math::BigInt'->new($_);
                                              'Math::BigInt'->new('0')->beq($got);
                                          },
                                'name' => 'Math::BigInt->new("0")->beq($_)',
                                'operator' => 'CODE(...)'
                              }, 'Test2::Compare::Custom' ),
               'h2' => bless( {
                                '_file' => '(eval 483)',
                                '_lines' => [
                                              7
                                            ],
                                'code' => sub {
                                              BEGIN {${^WARNING_BITS} = "\x55\x55\x55\x55\x55\x55\x55\x55\x55\x55\x55\x55\x15\x00\x04\x40\x05\x04\x50"}
                                              use strict;
                                              no feature ':all';
                                              use feature ':5.16';
                                              require Math::BigInt;
                                              my $got = 'Math::BigInt'->new($_);
                                              'Math::BigInt'->new('0')->beq($got);
                                          },
                                'name' => 'Math::BigInt->new("0")->beq($_)',
                                'operator' => 'CODE(...)'
                              }, 'Test2::Compare::Custom' ),
               'h3' => bless( {
                                '_file' => '(eval 476)',
                                '_lines' => [
                                              7
                                            ],
                                'code' => sub {
                                              BEGIN {${^WARNING_BITS} = "\x55\x55\x55\x55\x55\x55\x55\x55\x55\x55\x55\x55\x15\x00\x04\x40\x05\x04\x50"}
                                              use strict;
                                              no feature ':all';
                                              use feature ':5.16';
                                              require Math::BigInt;
                                              my $got = 'Math::BigInt'->new($_);
                                              'Math::BigInt'->new('0')->beq($got);
                                          },
                                'name' => 'Math::BigInt->new("0")->beq($_)',
                                'operator' => 'CODE(...)'
                              }, 'Test2::Compare::Custom' ),
               'o1' => bless( {
                                '_file' => '(eval 477)',
                                '_lines' => [
                                              7
                                            ],
                                'code' => sub {
                                              BEGIN {${^WARNING_BITS} = "\x55\x55\x55\x55\x55\x55\x55\x55\x55\x55\x55\x55\x15\x00\x04\x40\x05\x04\x50"}
                                              use strict;
                                              no feature ':all';
                                              use feature ':5.16';
                                              require Math::BigInt;
                                              my $got = 'Math::BigInt'->new($_);
                                              'Math::BigInt'->new('0')->beq($got);
                                          },
                                'name' => 'Math::BigInt->new("0")->beq($_)',
                                'operator' => 'CODE(...)'
                              }, 'Test2::Compare::Custom' )
             };


my $actual = from_toml(q|d1 = 0
d2 = +0
d3 = -0

h1 = 0x0
h2 = 0x00
h3 = 0x00000

o1 = 0o0
a2 = 0o00
a3 = 0o00000

b1 = 0b0
b2 = 0b00
b3 = 0b00000
|);

is($actual, $expected1, 'integer/zero - from_toml') or do{
  diag 'EXPECTED:';
  diag Dumper($expected1);

  diag '';
  diag 'ACTUAL:';
  diag Dumper($actual);
};

my $regenerated = to_toml $actual;
my $reparsed    = eval{ scalar from_toml $regenerated };
my $error       = $@;

is($error, U, 'integer/zero - to_toml - no errors');

is($reparsed, $expected1, 'integer/zero - to_toml') or do{
  diag "ERROR: $error" if $error;

  diag 'INPUT:';
  diag Dumper($actual);

  diag '';
  diag 'REGENERATED TOML:';
  diag Dumper($regenerated);

  diag '';
  diag 'REPARSED FROM REGENERATED TOML:';
  diag Dumper($reparsed);
};

done_testing;